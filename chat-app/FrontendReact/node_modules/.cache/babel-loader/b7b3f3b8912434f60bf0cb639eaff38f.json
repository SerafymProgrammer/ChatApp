{"ast":null,"code":"import _regeneratorRuntime from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _defineProperty from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{Component}from\"react\";import InputMessageForm from\"./chat-components/inputMessage\";import MessageContainer from\"./chat-components/messageContainer\";import UsersList from\"./chat-components/usersContainer\";import*as actions from\"../../redux/actions/chatActions/chat.actions\";import{connect}from\"react-redux\";import{Container}from\"@material-ui/core\";import{styled}from\"@material-ui/core/styles\";import Header from\"./chat-components/chatHeader\";import{withStyles}from'material-ui/styles';import store from'store';var styles=function styles(theme){var _chatContainer;return{chatContainer:(_chatContainer={background:\"#6d81af\",display:\"flex\",flexDirection:\"row-reverse\",margin:0,padding:0,height:800,position:'relative',maxHeight:1000},_defineProperty(_chatContainer,theme.breakpoints.down('xs'),{height:300,maxHeight:600}),_defineProperty(_chatContainer,theme.breakpoints.down('sm'),{height:600,maxHeight:800}),_chatContainer)};};var ChatContainer=styled(Container)({background:\"#6d81af\",display:\"flex\",flexDirection:\"row-reverse\",margin:0,padding:0,height:800,position:'relative',maxHeight:1000,\"@media (max-height:900px)\":{height:700,maxHeight:900},\"@media (max-height:800px)\":{height:600,maxHeight:800},\"@media (max-height:700px)\":{height:500,maxHeight:700},\"@media (max-height:600px)\":{height:400,maxHeight:600},\"@media (max-height:500px)\":{height:300,maxHeight:500},\"@media (max-height:400px)\":{height:200,maxHeight:400}});var ChatPage=/*#__PURE__*/function(_Component){_inherits(ChatPage,_Component);var _super=_createSuper(ChatPage);function ChatPage(props){var _this;_classCallCheck(this,ChatPage);_this=_super.call(this,props);_this.colorNickName=\"white\";_this.state={messages:[],isAdmin:false,nickName:\"\",isMuted:false,showUsersContainer:true};return _this;}_createClass(ChatPage,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.props.isConnected(false);}},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var socket,_store$get,nickNameColor,isAdmin,nickName;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.props.initConnection();case 2:socket=this.props.socket;socket.on(\"users\",function(res){_this2.props.setUsers(res);});socket.on(\"previousMessages\",function(res){return _this2.setState({messages:res});});socket.on(\"error\",function(msg){alert(msg);_this2.props.history.push('/login');});socket.on(\"initialMuteStatus\",function(IsMute){_this2.setState({isMuted:IsMute});});socket.on(\"mute\",function(IsMute){_this2.setState({isMuted:IsMute});});socket.on(\"chat\",function(res){return _this2.setState({messages:[].concat(_toConsumableArray(_this2.state.messages),[res])});});socket.on(\"disconnect\",function(socket){store.clearAll();_this2.props.history.push('/login');});_store$get=store.get('userData'),nickNameColor=_store$get.nickNameColor,isAdmin=_store$get.isAdmin,nickName=_store$get.nickName;this.colorNickName=nickNameColor;this.setState({isAdmin:isAdmin,nickName:nickName});this.props.isConnected(true);case 14:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"setMuteStatus\",value:function setMuteStatus(user){this.props.socket.emit(\"mute\",user.id);}},{key:\"setBan\",value:function setBan(id){this.props.socket.emit(\"ban\",id);}},{key:\"sendMsg\",value:function sendMsg(message){this.props.socket.emit(\"chat\",message);}},{key:\"logout\",value:function(){var _logout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return localStorage.removeItem(\"userToken\");case 2:this.props.socket.disconnect(true);this.props.history.push('/login');case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function logout(){return _logout.apply(this,arguments);}return logout;}()},{key:\"render\",value:function render(){var _this3=this;var _this$props=this.props,isConnected=_this$props.isConnected,users=_this$props.users,classes=_this$props.classes;var _this$state=this.state,isAdmin=_this$state.isAdmin,nickName=_this$state.nickName,showUsersContainer=_this$state.showUsersContainer,messages=_this$state.messages;return isConnected&&users.length>0?/*#__PURE__*/React.createElement(Container,{style:{display:\"flex\",flexDirection:\"column\"}},/*#__PURE__*/React.createElement(Header,{username:nickName,colorNickName:this.colorNickName,showHideUsersList:function showHideUsersList(){return _this3.setState({showUsersContainer:!_this3.state.showUsersContainer});},logout:function logout(){return _this3.logout();}}),/*#__PURE__*/React.createElement(Container,{className:classes.chatContainer},/*#__PURE__*/React.createElement(UsersList,{users:users,isAdmin:isAdmin,userName:nickName,setMuteStatus:function setMuteStatus(user){return _this3.setMuteStatus(user);},setBan:function setBan(user){return _this3.setBan(user);},showUsersContainer:showUsersContainer}),/*#__PURE__*/React.createElement(MessageContainer,{messages:messages,username:nickName})),!this.state.isMuted?/*#__PURE__*/React.createElement(InputMessageForm,{handleSubmit:function handleSubmit(message){return _this3.sendMsg(message);}}):null):null;}}]);return ChatPage;}(Component);function mapStateToProps(state){return{isConnected:state.chatReducer.isConnected,users:state.chatReducer.users,messages:state.chatReducer.messages,socket:state.chatReducer.socket};}function mapDispatchToProps(dispatch){return{initConnection:function initConnection(){return dispatch(actions.initWebSocketConnection(dispatch));},setUsers:function setUsers(users){return dispatch(actions.setUsers(users));},isConnected:function isConnected(status){return dispatch(actions.isConnected(status));}};}export default connect(mapStateToProps,mapDispatchToProps)(withStyles(styles)(ChatPage));","map":{"version":3,"sources":["/home/serafym/Общедоступные/ChatApp/chat-app/FrontendReact/src/components/chatPage/chat.jsx"],"names":["React","Component","InputMessageForm","MessageContainer","UsersList","actions","connect","Container","styled","Header","withStyles","store","styles","theme","chatContainer","background","display","flexDirection","margin","padding","height","position","maxHeight","breakpoints","down","ChatContainer","ChatPage","props","colorNickName","state","messages","isAdmin","nickName","isMuted","showUsersContainer","isConnected","initConnection","socket","on","res","setUsers","setState","msg","alert","history","push","IsMute","clearAll","get","nickNameColor","user","emit","id","message","localStorage","removeItem","disconnect","users","classes","length","logout","setMuteStatus","setBan","sendMsg","mapStateToProps","chatReducer","mapDispatchToProps","dispatch","initWebSocketConnection","status"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport InputMessageForm from \"./chat-components/inputMessage\";\nimport MessageContainer from \"./chat-components/messageContainer\";\nimport UsersList from \"./chat-components/usersContainer\";\nimport * as actions from \"../../redux/actions/chatActions/chat.actions\";\nimport { connect } from \"react-redux\";\nimport { Container } from \"@material-ui/core\";\nimport { styled } from \"@material-ui/core/styles\";\nimport Header from \"./chat-components/chatHeader\";\nimport { withStyles } from 'material-ui/styles';\nimport store from 'store';\n\nconst styles = theme => ({\n  chatContainer: {\n    background: \"#6d81af\",\n    display: \"flex\",\n    flexDirection: \"row-reverse\",\n    margin: 0,\n    padding: 0,\n    height: 800,\n    position: 'relative',\n    maxHeight: 1000,\n    [theme.breakpoints.down('xs')]: {\n      height: 300,\n      maxHeight: 600,\n    },\n    [theme.breakpoints.down('sm')]: {\n      height: 600,\n      maxHeight: 800,\n    },\n  },\n});\n\nconst ChatContainer = styled(Container)({\n  background: \"#6d81af\",\n  display: \"flex\",\n  flexDirection: \"row-reverse\",\n  margin: 0,\n  padding: 0,\n  height: 800,\n  position: 'relative',\n  maxHeight: 1000,\n  \"@media (max-height:900px)\": {\n    height: 700,\n    maxHeight: 900,\n  },\n  \"@media (max-height:800px)\": {\n    height: 600,\n    maxHeight: 800,\n  },\n  \"@media (max-height:700px)\": {\n    height: 500,\n    maxHeight: 700,\n  },\n  \"@media (max-height:600px)\": {\n    height: 400,\n    maxHeight: 600,\n  },\n  \"@media (max-height:500px)\": {\n    height: 300,\n    maxHeight: 500,\n  },\n  \"@media (max-height:400px)\": {\n    height: 200,\n    maxHeight: 400,\n  },\n});\n\nclass ChatPage extends Component {\n  colorNickName = \"white\";\n  constructor(props) {\n    super(props);\n    this.state = {\n      messages: [],\n      isAdmin: false,\n      nickName: \"\",\n      isMuted: false,\n      showUsersContainer: true,\n    };\n  }\n\n  componentWillUnmount() {\n    this.props.isConnected(false);\n  }\n\n  async componentDidMount() {\n    await this.props.initConnection();\n\n    const {socket} = this.props;\n\n    socket.on(\"users\", (res) => {\n      this.props.setUsers(res);\n    });\n\n    socket.on(\"previousMessages\", (res) =>\n      this.setState({\n        messages: res,\n      })\n    );\n\n    socket.on(\"error\", (msg) =>{\n      alert(msg);\n      this.props.history.push('/login');\n    });\n\n    socket.on(\"initialMuteStatus\", (IsMute) =>{\n      this.setState({ isMuted: IsMute });\n    });\n\n    socket.on(\"mute\", (IsMute) => {\n      this.setState({ isMuted: IsMute });\n    });\n\n    socket.on(\"chat\", (res) =>\n      this.setState({\n        messages: [...this.state.messages, res],\n      })\n    );\n\n    socket.on(\"disconnect\", (socket) => {\n      store.clearAll();\n      this.props.history.push('/login');\n    });\n    const {nickNameColor, isAdmin, nickName} = store.get('userData');\n    this.colorNickName = nickNameColor;\n    this.setState({\n      isAdmin,\n      nickName\n    });\n\n    this.props.isConnected(true);\n  }\n\n  setMuteStatus(user) {\n    this.props.socket.emit(\"mute\", user.id);\n  }\n\n  setBan(id) {\n    this.props.socket.emit(\"ban\", id);\n  }\n\n  sendMsg(message) {\n    this.props.socket.emit(\"chat\", message);\n  }\n\n  async logout() {\n    await localStorage.removeItem(\"userToken\");\n    this.props.socket.disconnect(true);\n    this.props.history.push('/login');\n  }\n\n  render() {\n\n    const { isConnected, users, classes } = this.props;\n    const { isAdmin, nickName, showUsersContainer, messages} = this.state;\n\n    return isConnected && users.length>0 ? (\n      <Container style={{ display: \"flex\", flexDirection: \"column\" }}>\n        <Header\n          username={nickName}\n          colorNickName={this.colorNickName}\n          showHideUsersList={() =>\n            this.setState({\n              showUsersContainer: !this.state.showUsersContainer,\n            })\n          }\n          logout={() => this.logout()}\n        />\n        <Container className={classes.chatContainer}>\n          <UsersList\n            users={users}\n            isAdmin={isAdmin}\n            userName={nickName}\n            setMuteStatus={(user) => this.setMuteStatus(user)}\n            setBan={(user) => this.setBan(user)}\n            showUsersContainer={showUsersContainer}\n          />\n          <MessageContainer\n            messages={messages}\n            username={nickName}\n          />\n        </Container>\n        {!this.state.isMuted ? (\n          <InputMessageForm handleSubmit={(message) => this.sendMsg(message)} />\n        ) : null}\n      </Container>\n    ) : null;\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    isConnected: state.chatReducer.isConnected,\n    users: state.chatReducer.users,\n    messages: state.chatReducer.messages,\n    socket: state.chatReducer.socket,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    initConnection: () => dispatch(actions.initWebSocketConnection(dispatch)),\n    setUsers: (users) => dispatch(actions.setUsers(users)),\n    isConnected: (status) => dispatch(actions.isConnected(status)),\n  };\n}\n\nexport default  connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(ChatPage));\n"]},"metadata":{},"sourceType":"module"}