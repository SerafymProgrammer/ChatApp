{"ast":null,"code":"import _toConsumableArray from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useEffect,useCallback,useState}from\"react\";import{useDispatch,useSelector,shallowEqual}from\"react-redux\";import InputMessageForm from\"./chat-components/inputMessage\";import MessageContainer from\"./chat-components/messageContainer\";import UsersList from\"./chat-components/usersContainer\";import*as actions from\"../../redux/actions/chatActions/chat.actions\";import*as authActions from\"../../redux/actions/authActions/auth.actions\";import ChatService from\"../../services/chat.service\";import{Container}from\"@material-ui/core\";import Header from\"./chat-components/chatHeader\";import store from\"store\";import{makeStyles}from\"@material-ui/core/styles\";import DrawerChatRooms from'./chat-components/drawerRooms';var useStyles=makeStyles(function(theme){var _chatContainer;return{chatContainer:(_chatContainer={background:\"#6d81af\",display:\"flex\",flexDirection:\"row-reverse\",margin:0,padding:0,height:800,position:\"relative\",maxHeight:1000},_defineProperty(_chatContainer,theme.breakpoints.down(\"xs\"),{height:300,maxHeight:600}),_defineProperty(_chatContainer,theme.breakpoints.down(\"sm\"),{height:600,maxHeight:800}),_chatContainer),chatList:{width:400}};});var ChatPage=function ChatPage(props){var classes=useStyles();var _store$get=store.get(\"userData\"),nickNameColor=_store$get.nickNameColor,isAdmin=_store$get.isAdmin,nickName=_store$get.nickName;var colorNickName=nickNameColor;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isCurrentUserAdmin=_useState4[0],setIsAdmin=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),currentUserNickName=_useState6[0],setNickName=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isMuted=_useState8[0],setIsMuted=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),showUsersContainer=_useState10[0],setShowUsersContainer=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showRoomsContainer=_useState12[0],setShowRoomsContainer=_useState12[1];var dispatch=useDispatch();var isConnected=useSelector(function(state){return state.chatReducer.isConnected;},shallowEqual);var users=useSelector(function(state){return state.chatReducer.users;},shallowEqual);var socket=useSelector(function(state){return state.chatReducer.socket;},shallowEqual);var focusRoom=useSelector(function(state){return state.chatReducer.focusRoom;},shallowEqual);var initConnection=useCallback(function(){return dispatch(actions.initWebSocketConnection(dispatch));},[dispatch]);var setUsers=useCallback(function(user){return dispatch(actions.setUsers(user));},[dispatch]);var setRooms=useCallback(function(rooms){return dispatch(actions.setRooms(rooms));},[dispatch]);var setFocusRoom=useCallback(function(room){return dispatch(actions.setFocusRoom(room));},[dispatch]);var setIsConnected=useCallback(function(status){return dispatch(actions.isConnected(status));},[dispatch]);var isSignedInUser=useCallback(function(status){return dispatch(authActions.isSignedInUser(status));},[dispatch]);var _logout=useCallback(function(){socket.disconnect(true);disconnnectAndLogout();});var disconnnectAndLogout=useCallback(function(){store.clearAll();isSignedInUser(false);ChatService.changeExists();props.history.push(\"/login\");});var goToOneToOneRoome=function goToOneToOneRoome(id){return socket.emit(\"joinRoom\",id);};var _setMuteStatus=function setMuteStatus(id){return socket.emit(\"mute\",id);};var _setBan=function setBan(id){return socket.emit(\"ban\",id);};var sendMsg=useCallback(function(textMessage){return socket.emit(\"chat\",{textMessage:textMessage,focusRoom:focusRoom});});useEffect(function(){initConnection();if(socket){socket.on(\"users\",function(res){return setUsers(res);});socket.on(\"previousMessages\",function(res){return setMessages(res);});socket.on(\"error\",function(msg){alert(msg);props.history.push(\"/login\");});socket.on(\"initialMuteStatus\",function(isMuted){return setIsMuted(isMuted);});socket.on(\"rooms\",function(rooms){setRooms(rooms);});socket.on(\"focusRoom\",function(room){setFocusRoom(room);});socket.on(\"mute\",function(isMuted){return setIsMuted(isMuted);});socket.on(\"chat\",function(msg){return setMessages([].concat(_toConsumableArray(messages),[msg]));});socket.on(\"disconnect\",function(socket){disconnnectAndLogout();});setIsAdmin(isAdmin);setNickName(nickName);setIsConnected(true);}return function(){return setIsConnected(false);};},[users,socket,messages]);return isConnected&&users.length>0?/*#__PURE__*/React.createElement(Container,{style:{display:\"flex\",flexDirection:\"column\"}},/*#__PURE__*/React.createElement(Header,{username:nickName,colorNickName:colorNickName,showHideUsersList:function showHideUsersList(){return setShowUsersContainer(!showUsersContainer);},logout:function logout(){return _logout();}}),/*#__PURE__*/React.createElement(Container,{className:classes.chatContainer},/*#__PURE__*/React.createElement(UsersList,{users:users,isAdmin:isCurrentUserAdmin,userName:currentUserNickName,setMuteStatus:function setMuteStatus(user){return _setMuteStatus(user);},setBan:function setBan(user){return _setBan(user);},showUsersContainer:showUsersContainer,goToOneToOneRoome:goToOneToOneRoome}),/*#__PURE__*/React.createElement(MessageContainer,{messages:messages,username:nickName}),/*#__PURE__*/React.createElement(DrawerChatRooms,{goToOneToOneRoome:goToOneToOneRoome,showRoomsContainer:showRoomsContainer,setShowRoomsContainer:setShowRoomsContainer,currentUserName:currentUserNickName})),!isMuted?/*#__PURE__*/React.createElement(InputMessageForm,{handleSubmit:function handleSubmit(message){return sendMsg(message);}}):null):null;};export default ChatPage;","map":{"version":3,"sources":["/home/serafym/Общедоступные/ChatApp/chat-app/FrontendReact/src/components/chatPage/chat.jsx"],"names":["React","useEffect","useCallback","useState","useDispatch","useSelector","shallowEqual","InputMessageForm","MessageContainer","UsersList","actions","authActions","ChatService","Container","Header","store","makeStyles","DrawerChatRooms","useStyles","theme","chatContainer","background","display","flexDirection","margin","padding","height","position","maxHeight","breakpoints","down","chatList","width","ChatPage","props","classes","get","nickNameColor","isAdmin","nickName","colorNickName","messages","setMessages","isCurrentUserAdmin","setIsAdmin","currentUserNickName","setNickName","isMuted","setIsMuted","showUsersContainer","setShowUsersContainer","showRoomsContainer","setShowRoomsContainer","dispatch","isConnected","state","chatReducer","users","socket","focusRoom","initConnection","initWebSocketConnection","setUsers","user","setRooms","rooms","setFocusRoom","room","setIsConnected","status","isSignedInUser","logout","disconnect","disconnnectAndLogout","clearAll","changeExists","history","push","goToOneToOneRoome","id","emit","setMuteStatus","setBan","sendMsg","textMessage","on","res","msg","alert","length","message"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useState } from \"react\";\nimport { useDispatch, useSelector, shallowEqual } from \"react-redux\";\nimport InputMessageForm from \"./chat-components/inputMessage\";\nimport MessageContainer from \"./chat-components/messageContainer\";\nimport UsersList from \"./chat-components/usersContainer\";\nimport * as actions from \"../../redux/actions/chatActions/chat.actions\";\nimport * as authActions from \"../../redux/actions/authActions/auth.actions\";\nimport ChatService from \"../../services/chat.service\";\nimport { Container } from \"@material-ui/core\";\nimport Header from \"./chat-components/chatHeader\";\nimport store from \"store\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nimport DrawerChatRooms from './chat-components/drawerRooms'\n\nconst useStyles = makeStyles((theme) => ({\n  chatContainer: {\n    background: \"#6d81af\",\n    display: \"flex\",\n    flexDirection: \"row-reverse\",\n    margin: 0,\n    padding: 0,\n    height: 800,\n    position: \"relative\",\n    maxHeight: 1000,\n    [theme.breakpoints.down(\"xs\")]: {\n      height: 300,\n      maxHeight: 600,\n    },\n    [theme.breakpoints.down(\"sm\")]: {\n      height: 600,\n      maxHeight: 800,\n    },\n  },\n  chatList: {\n    width: 400, \n  }\n}));\n\nconst ChatPage = (props) => {\n  const classes = useStyles();\n\n  const { nickNameColor, isAdmin, nickName } = store.get(\"userData\");\n  let colorNickName = nickNameColor;\n\n  const [messages, setMessages] = useState([]);\n  const [isCurrentUserAdmin, setIsAdmin] = useState(false);\n  const [currentUserNickName, setNickName] = useState(\"\");\n  const [isMuted, setIsMuted] = useState(false);\n  const [showUsersContainer, setShowUsersContainer] = useState(true);\n  const [showRoomsContainer, setShowRoomsContainer] = useState(false);\n \n\n  const dispatch = useDispatch();\n\n  const isConnected = useSelector(\n    (state) => state.chatReducer.isConnected,\n    shallowEqual\n  );\n  const users = useSelector((state) => state.chatReducer.users, shallowEqual);\n  const socket = useSelector((state) => state.chatReducer.socket, shallowEqual);\n  const focusRoom = useSelector(\n    (state) => state.chatReducer.focusRoom,\n    shallowEqual\n  );\n\n  const initConnection = useCallback(\n    () => dispatch(actions.initWebSocketConnection(dispatch)),\n    [dispatch]\n  );\n  const setUsers = useCallback((user) => dispatch(actions.setUsers(user)), [\n    dispatch,\n  ]);\n  const setRooms = useCallback((rooms) => dispatch(actions.setRooms(rooms)), [\n    dispatch,\n  ]);\n\n  const setFocusRoom = useCallback((room) => dispatch(actions.setFocusRoom(room)), [\n    dispatch,\n  ]);\n\n  const setIsConnected = useCallback(\n    (status) => dispatch(actions.isConnected(status)),\n    [dispatch]\n  );\n  const isSignedInUser = useCallback(\n    (status) => dispatch(authActions.isSignedInUser(status)),\n    [dispatch]\n  );\n  const logout = useCallback(() => {\n    socket.disconnect(true);\n    disconnnectAndLogout();\n  });\n  const disconnnectAndLogout = useCallback(() => {\n    store.clearAll();\n    isSignedInUser(false);\n    ChatService.changeExists();\n    props.history.push(\"/login\");\n  });\n  \n  const goToOneToOneRoome = (id) => socket.emit(\"joinRoom\", id);\n  const setMuteStatus = (id) => socket.emit(\"mute\", id);\n  const setBan = (id) => socket.emit(\"ban\", id);\n  const sendMsg = useCallback((textMessage) => socket.emit(\"chat\", {textMessage, focusRoom}));\n\n  useEffect(() => {\n    initConnection();\n    if (socket) {\n      socket.on(\"users\", (res) => setUsers(res));\n\n      socket.on(\"previousMessages\", (res) => setMessages(res));\n\n      socket.on(\"error\", (msg) => {\n        alert(msg);\n        props.history.push(\"/login\");\n      });\n\n      socket.on(\"initialMuteStatus\", (isMuted) => setIsMuted(isMuted));\n\n      socket.on(\"rooms\", (rooms) => {\n        setRooms(rooms);\n      });\n\n      socket.on(\"focusRoom\", (room) => {\n        setFocusRoom(room);\n      });\n\n      socket.on(\"mute\", (isMuted) => setIsMuted(isMuted));\n\n      socket.on(\"chat\", (msg) => setMessages([...messages, msg]));\n\n      socket.on(\"disconnect\", (socket) => {\n        disconnnectAndLogout();\n      });\n      setIsAdmin(isAdmin);\n      setNickName(nickName);\n      setIsConnected(true);\n    }\n    return () => setIsConnected(false);\n  }, [users, socket, messages]);\n\n  return isConnected && users.length > 0 ? (\n    <Container style={{ display: \"flex\", flexDirection: \"column\" }}>\n      <Header\n        username={nickName}\n        colorNickName={colorNickName}\n        showHideUsersList={() => setShowUsersContainer(!showUsersContainer)}\n        logout={() => logout()}\n      />\n\n      <Container className={classes.chatContainer}>\n        <UsersList\n          users={users}\n          isAdmin={isCurrentUserAdmin}\n          userName={currentUserNickName}\n          setMuteStatus={(user) => setMuteStatus(user)}\n          setBan={(user) => setBan(user)}\n          showUsersContainer={showUsersContainer}\n          goToOneToOneRoome={goToOneToOneRoome}\n        />\n        <MessageContainer messages={messages} username={nickName} />\n        <DrawerChatRooms\n          goToOneToOneRoome={goToOneToOneRoome}\n          showRoomsContainer={showRoomsContainer}\n          setShowRoomsContainer={setShowRoomsContainer}\n          currentUserName = {currentUserNickName}\n        />\n      </Container>\n      {!isMuted ? (\n        <InputMessageForm handleSubmit={(message) => sendMsg(message)} />\n      ) : null}\n    </Container>\n  ) : null;\n};\n\nexport default ChatPage;\n"]},"metadata":{},"sourceType":"module"}