{"ast":null,"code":"var _jsxFileName = \"/home/serafym/\\u041E\\u0431\\u0449\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435/ChatApp/chat-app/FrontendReact/src/components/chatPage/chat.jsx\";\nimport React, { useEffect, useCallback, useState } from \"react\";\nimport { useDispatch, useSelector, shallowEqual } from \"react-redux\";\nimport InputMessageForm from \"./chat-components/inputMessage\";\nimport MessageContainer from \"./chat-components/messageContainer\";\nimport UsersList from \"./chat-components/usersContainer\";\nimport * as actions from \"../../redux/actions/chatActions/chat.actions\";\nimport * as authActions from \"../../redux/actions/authActions/auth.actions\";\nimport ChatService from \"../../services/chat.service\";\nimport { Container } from \"@material-ui/core\";\nimport Header from \"./chat-components/chatHeader\";\nimport store from \"store\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport DrawerChatRooms from './chat-components/drawerRooms';\nconst useStyles = makeStyles(theme => ({\n  chatContainer: {\n    background: \"#6d81af\",\n    display: \"flex\",\n    flexDirection: \"row-reverse\",\n    margin: 0,\n    padding: 0,\n    height: 800,\n    position: \"relative\",\n    maxHeight: 1000,\n    [theme.breakpoints.down(\"xs\")]: {\n      height: 300,\n      maxHeight: 600\n    },\n    [theme.breakpoints.down(\"sm\")]: {\n      height: 600,\n      maxHeight: 800\n    }\n  },\n  chatList: {\n    width: 400\n  }\n}));\n\nconst ChatPage = props => {\n  const classes = useStyles();\n  const {\n    nickNameColor,\n    isAdmin,\n    nickName\n  } = store.get(\"userData\");\n  let colorNickName = nickNameColor;\n  const [messages, setMessages] = useState([]);\n  const [isCurrentUserAdmin, setIsAdmin] = useState(false);\n  const [currentUserNickName, setNickName] = useState(\"\");\n  const [isMuted, setIsMuted] = useState(false);\n  const [showUsersContainer, setShowUsersContainer] = useState(true);\n  const [showRoomsContainer, setShowRoomsContainer] = useState(false);\n  const dispatch = useDispatch();\n  const isConnected = useSelector(state => state.chatReducer.isConnected, shallowEqual);\n  const users = useSelector(state => state.chatReducer.users, shallowEqual);\n  const socket = useSelector(state => state.chatReducer.socket, shallowEqual);\n  const focusRoom = useSelector(state => state.chatReducer.focusRoom, shallowEqual);\n  const initConnection = useCallback(() => dispatch(actions.initWebSocketConnection(dispatch)), [dispatch]);\n  const setUsers = useCallback(user => dispatch(actions.setUsers(user)), [dispatch]);\n  const setRooms = useCallback(rooms => dispatch(actions.setRooms(rooms)), [dispatch]);\n  const setFocusRoom = useCallback(room => dispatch(actions.setFocusRoom(room)), [dispatch]);\n  const setIsConnected = useCallback(status => dispatch(actions.isConnected(status)), [dispatch]);\n  const isSignedInUser = useCallback(status => dispatch(authActions.isSignedInUser(status)), [dispatch]);\n  const logout = useCallback(() => {\n    socket.disconnect(true);\n    disconnnectAndLogout();\n  });\n  const disconnnectAndLogout = useCallback(() => {\n    store.clearAll();\n    isSignedInUser(false);\n    ChatService.changeExists();\n    props.history.push(\"/login\");\n  });\n\n  const goToOneToOneRoome = id => socket.emit(\"joinRoom\", id);\n\n  const setMuteStatus = id => socket.emit(\"mute\", id);\n\n  const setBan = id => socket.emit(\"ban\", id);\n\n  const sendMsg = useCallback(textMessage => socket.emit(\"chat\", {\n    textMessage,\n    focusRoom\n  }));\n  useEffect(() => {\n    initConnection();\n\n    if (socket) {\n      socket.on(\"users\", res => setUsers(res));\n      socket.on(\"previousMessages\", res => setMessages(res));\n      socket.on(\"error\", msg => {\n        alert(msg);\n        props.history.push(\"/login\");\n      });\n      socket.on(\"initialMuteStatus\", isMuted => setIsMuted(isMuted));\n      socket.on(\"rooms\", rooms => {\n        setRooms(rooms);\n      });\n      socket.on(\"focusRoom\", room => {\n        setFocusRoom(room);\n      });\n      socket.on(\"mute\", isMuted => setIsMuted(isMuted));\n      socket.on(\"chat\", msg => setMessages([...messages, msg]));\n      socket.on(\"disconnect\", socket => {\n        disconnnectAndLogout();\n      });\n      setIsAdmin(isAdmin);\n      setNickName(nickName);\n      setIsConnected(true);\n    }\n\n    return () => setIsConnected(false);\n  }, [users, socket, messages]);\n  return isConnected && users.length > 0 ? /*#__PURE__*/React.createElement(Container, {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    username: nickName,\n    colorNickName: colorNickName,\n    showHideUsersList: () => setShowUsersContainer(!showUsersContainer),\n    setShowRoomsContainer: () => setShowRoomsContainer(!showRoomsContainer),\n    logout: () => logout(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    className: classes.chatContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(UsersList, {\n    users: users,\n    isAdmin: isCurrentUserAdmin,\n    userName: currentUserNickName,\n    setMuteStatus: user => setMuteStatus(user),\n    setBan: user => setBan(user),\n    showUsersContainer: showUsersContainer,\n    goToOneToOneRoome: goToOneToOneRoome,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(MessageContainer, {\n    messages: messages,\n    username: nickName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(DrawerChatRooms, {\n    goToOneToOneRoome: goToOneToOneRoome,\n    showRoomsContainer: showRoomsContainer,\n    setShowRoomsContainer: setShowRoomsContainer,\n    currentUserName: currentUserNickName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }\n  })), !isMuted ? /*#__PURE__*/React.createElement(InputMessageForm, {\n    handleSubmit: message => sendMsg(message),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 9\n    }\n  }) : null) : null;\n};\n\nexport default ChatPage;","map":{"version":3,"sources":["/home/serafym/Общедоступные/ChatApp/chat-app/FrontendReact/src/components/chatPage/chat.jsx"],"names":["React","useEffect","useCallback","useState","useDispatch","useSelector","shallowEqual","InputMessageForm","MessageContainer","UsersList","actions","authActions","ChatService","Container","Header","store","makeStyles","DrawerChatRooms","useStyles","theme","chatContainer","background","display","flexDirection","margin","padding","height","position","maxHeight","breakpoints","down","chatList","width","ChatPage","props","classes","nickNameColor","isAdmin","nickName","get","colorNickName","messages","setMessages","isCurrentUserAdmin","setIsAdmin","currentUserNickName","setNickName","isMuted","setIsMuted","showUsersContainer","setShowUsersContainer","showRoomsContainer","setShowRoomsContainer","dispatch","isConnected","state","chatReducer","users","socket","focusRoom","initConnection","initWebSocketConnection","setUsers","user","setRooms","rooms","setFocusRoom","room","setIsConnected","status","isSignedInUser","logout","disconnect","disconnnectAndLogout","clearAll","changeExists","history","push","goToOneToOneRoome","id","emit","setMuteStatus","setBan","sendMsg","textMessage","on","res","msg","alert","length","message"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useState } from \"react\";\nimport { useDispatch, useSelector, shallowEqual } from \"react-redux\";\nimport InputMessageForm from \"./chat-components/inputMessage\";\nimport MessageContainer from \"./chat-components/messageContainer\";\nimport UsersList from \"./chat-components/usersContainer\";\nimport * as actions from \"../../redux/actions/chatActions/chat.actions\";\nimport * as authActions from \"../../redux/actions/authActions/auth.actions\";\nimport ChatService from \"../../services/chat.service\";\nimport { Container } from \"@material-ui/core\";\nimport Header from \"./chat-components/chatHeader\";\nimport store from \"store\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nimport DrawerChatRooms from './chat-components/drawerRooms'\n\nconst useStyles = makeStyles((theme) => ({\n  chatContainer: {\n    background: \"#6d81af\",\n    display: \"flex\",\n    flexDirection: \"row-reverse\",\n    margin: 0,\n    padding: 0,\n    height: 800,\n    position: \"relative\",\n    maxHeight: 1000,\n    [theme.breakpoints.down(\"xs\")]: {\n      height: 300,\n      maxHeight: 600,\n    },\n    [theme.breakpoints.down(\"sm\")]: {\n      height: 600,\n      maxHeight: 800,\n    },\n  },\n  chatList: {\n    width: 400, \n  }\n}));\n\nconst ChatPage = (props) => {\n  const classes = useStyles();\n\n  const { nickNameColor, isAdmin, nickName } = store.get(\"userData\");\n  let colorNickName = nickNameColor;\n\n  const [messages, setMessages] = useState([]);\n  const [isCurrentUserAdmin, setIsAdmin] = useState(false);\n  const [currentUserNickName, setNickName] = useState(\"\");\n  const [isMuted, setIsMuted] = useState(false);\n  const [showUsersContainer, setShowUsersContainer] = useState(true);\n  const [showRoomsContainer, setShowRoomsContainer] = useState(false);\n \n\n  const dispatch = useDispatch();\n\n  const isConnected = useSelector(\n    (state) => state.chatReducer.isConnected,\n    shallowEqual\n  );\n  const users = useSelector((state) => state.chatReducer.users, shallowEqual);\n  const socket = useSelector((state) => state.chatReducer.socket, shallowEqual);\n  const focusRoom = useSelector(\n    (state) => state.chatReducer.focusRoom,\n    shallowEqual\n  );\n\n  const initConnection = useCallback(\n    () => dispatch(actions.initWebSocketConnection(dispatch)),\n    [dispatch]\n  );\n  const setUsers = useCallback((user) => dispatch(actions.setUsers(user)), [\n    dispatch,\n  ]);\n  const setRooms = useCallback((rooms) => dispatch(actions.setRooms(rooms)), [\n    dispatch,\n  ]);\n\n  const setFocusRoom = useCallback((room) => dispatch(actions.setFocusRoom(room)), [\n    dispatch,\n  ]);\n\n  const setIsConnected = useCallback(\n    (status) => dispatch(actions.isConnected(status)),\n    [dispatch]\n  );\n  const isSignedInUser = useCallback(\n    (status) => dispatch(authActions.isSignedInUser(status)),\n    [dispatch]\n  );\n  const logout = useCallback(() => {\n    socket.disconnect(true);\n    disconnnectAndLogout();\n  });\n  const disconnnectAndLogout = useCallback(() => {\n    store.clearAll();\n    isSignedInUser(false);\n    ChatService.changeExists();\n    props.history.push(\"/login\");\n  });\n  \n  const goToOneToOneRoome = (id) => socket.emit(\"joinRoom\", id);\n  const setMuteStatus = (id) => socket.emit(\"mute\", id);\n  const setBan = (id) => socket.emit(\"ban\", id);\n  const sendMsg = useCallback((textMessage) => socket.emit(\"chat\", {textMessage, focusRoom}));\n\n  useEffect(() => {\n    initConnection();\n    if (socket) {\n      socket.on(\"users\", (res) => setUsers(res));\n\n      socket.on(\"previousMessages\", (res) => setMessages(res));\n\n      socket.on(\"error\", (msg) => {\n        alert(msg);\n        props.history.push(\"/login\");\n      });\n\n      socket.on(\"initialMuteStatus\", (isMuted) => setIsMuted(isMuted));\n\n      socket.on(\"rooms\", (rooms) => {\n        setRooms(rooms);\n      });\n\n      socket.on(\"focusRoom\", (room) => {\n        setFocusRoom(room);\n      });\n\n      socket.on(\"mute\", (isMuted) => setIsMuted(isMuted));\n\n      socket.on(\"chat\", (msg) => setMessages([...messages, msg]));\n\n      socket.on(\"disconnect\", (socket) => {\n        disconnnectAndLogout();\n      });\n      setIsAdmin(isAdmin);\n      setNickName(nickName);\n      setIsConnected(true);\n    }\n    return () => setIsConnected(false);\n  }, [users, socket, messages]);\n\n  return isConnected && users.length > 0 ? (\n    <Container style={{ display: \"flex\", flexDirection: \"column\" }}>\n      <Header\n        username={nickName}\n        colorNickName={colorNickName}\n        showHideUsersList={() => setShowUsersContainer(!showUsersContainer)}\n        setShowRoomsContainer={() => setShowRoomsContainer(!showRoomsContainer)}\n        logout={() => logout()}\n      />\n\n      <Container className={classes.chatContainer}>\n        <UsersList\n          users={users}\n          isAdmin={isCurrentUserAdmin}\n          userName={currentUserNickName}\n          setMuteStatus={(user) => setMuteStatus(user)}\n          setBan={(user) => setBan(user)}\n          showUsersContainer={showUsersContainer}\n          goToOneToOneRoome={goToOneToOneRoome}\n        />\n        <MessageContainer messages={messages} username={nickName} />\n        <DrawerChatRooms\n          goToOneToOneRoome={goToOneToOneRoome}\n          showRoomsContainer={showRoomsContainer}\n          setShowRoomsContainer={setShowRoomsContainer}\n          currentUserName = {currentUserNickName}\n        />\n      </Container>\n      {!isMuted ? (\n        <InputMessageForm handleSubmit={(message) => sendMsg(message)} />\n      ) : null}\n    </Container>\n  ) : null;\n};\n\nexport default ChatPage;\n"]},"metadata":{},"sourceType":"module"}